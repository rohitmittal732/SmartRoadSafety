<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Smart Road Safety - Demo</title>

  <!-- React + ReactDOM UMD -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Babel for in-browser JSX (development/demo only) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Leaflet CSS & JS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>

  <style>
    /* small styles for custom markers if needed */
    .user-marker {
      box-sizing: border-box;
      transform: translate(-50%, -50%);
    }
    .zone-marker {
      transform: translate(-50%, -50%);
      text-align: center;
      line-height: 1;
    }
    .pedestrian-marker {
      transform: translate(-50%, -50%);
    }
    /* ensure root full height */
    html, body, #root { height: 100%; margin: 0; padding: 0; }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- React code (transpiled by Babel) -->
  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    /* Simple icon components (replace or extend as needed) */
    const Icon = ({ emoji, className = '' }) => <span className={className} style={{ fontSize: 18 }}>{emoji}</span>;
    const PhoneIcon = () => <Icon emoji="üìû" />;
    const AlertIcon = () => <Icon emoji="‚ö†Ô∏è" />;
    const CloudIcon = () => <Icon emoji="‚òÅÔ∏è" />;
    const MapPinIcon = () => <Icon emoji="üìç" />;
    const UsersIcon = () => <Icon emoji="üßç" />;
    const BellIcon = () => <Icon emoji="üîî" />;
    const SendIcon = () => <Icon emoji="üì§" />;

    function SmartRoadSafety() {
      const [activeTab, setActiveTab] = useState('map');
      const [speed, setSpeed] = useState(45);
      const [weather, setWeather] = useState({ condition: 'Clear', temperature: 28, visibility: 5000, humidity: 65 });
      const [alerts, setAlerts] = useState([]);
      const [userLocation] = useState({ lat: 26.9124, lng: 75.7873 });
      const [sidebarOpen, setSidebarOpen] = useState(true);
      const [showSOSModal, setShowSOSModal] = useState(false);
      const [showReportModal, setShowReportModal] = useState(false);
      const [sosStatus, setSosStatus] = useState('');
      const [pedestrians, setPedestrians] = useState([
        { id: 1, lat: 26.9130, lng: 75.7890 },
        { id: 2, lat: 26.9160, lng: 75.7910 },
        { id: 3, lat: 26.9190, lng: 75.7870 }
      ]);
      const [reportForm, setReportForm] = useState({ type: 'Pothole', description: '' });
      const [userReports, setUserReports] = useState([]);

      const mapDivRef = useRef(null);          // DOM ref for map container
      const leafletMapRef = useRef(null);      // holds Leaflet map instance
      const markersRef = useRef([]);           // general markers & circles
      const pedestrianMarkersRef = useRef([]); // pedestrian markers

      const accidentZones = [
        { lat: 26.9200, lng: 75.7900, type: 'accident', severity: 'high', name: 'MI Road Junction' },
        { lat: 26.9050, lng: 75.7800, type: 'accident', severity: 'medium', name: 'Tonk Road' },
        { lat: 26.9180, lng: 75.7950, type: 'pothole', severity: 'low', name: 'JLN Marg' }
      ];

      const nearbyServices = [
        { lat: 26.9150, lng: 75.7850, type: 'hospital', name: 'SMS Hospital', icon: 'üè•' },
        { lat: 26.9100, lng: 75.7920, type: 'police', name: 'Police Station', icon: 'üöì' },
        { lat: 26.9220, lng: 75.7880, type: 'fuel', name: 'Petrol Pump', icon: '‚õΩ' },
        { lat: 26.9080, lng: 75.7960, type: 'hospital', name: 'Fortis Hospital', icon: 'üè•' }
      ];

      const calculateDistance = (lat1, lon1, lat2, lon2) => {
        const R = 6371; // km
        const dLat = (lat2 - lat1) * Math.PI / 180;
        const dLon = (lon2 - lon1) * Math.PI / 180;
        const a = Math.sin(dLat/2) * Math.sin(dLat/2) + Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * Math.sin(dLon/2) * Math.sin(dLon/2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
        return R * c;
      };

      const alertUser = (message) => {
        try {
          const speech = new SpeechSynthesisUtterance(message);
          speech.rate = 0.9;
          window.speechSynthesis.speak(speech);
        } catch (e) {
          // no speech
        }
        try { if (navigator.vibrate) navigator.vibrate([200,100,200]); } catch(e){}
        setAlerts(prev => [...prev, { message, time: new Date().toLocaleTimeString(), id: Date.now() }]);
      };

      const handleSOS = () => {
        setSosStatus('sending');
        setTimeout(() => {
          alertUser('Emergency SOS activated!');
          setSosStatus('sent');
          setTimeout(() => {
            setShowSOSModal(false);
            setSosStatus('');
          }, 2000);
        }, 1000);
      };

      const submitReport = () => {
        const newReport = {
          ...reportForm,
          lat: userLocation.lat,
          lng: userLocation.lng,
          timestamp: new Date().toLocaleString(),
          id: Date.now()
        };
        setUserReports(prev => [...prev, newReport]);
        alertUser(reportForm.type + ' reported successfully!');
        setShowReportModal(false);
        setReportForm({ type: 'Pothole', description: '' });
      };

      // Simulate speed changes
      useEffect(() => {
        const speedInterval = setInterval(() => {
          const newSpeed = Math.floor(Math.random() * 120);
          setSpeed(newSpeed);
          if (newSpeed > 80) alertUser('Warning! Overspeeding at ' + newSpeed + ' km/h');
        }, 12000);
        return () => clearInterval(speedInterval);
      }, []);

      // Simulate weather
      useEffect(() => {
        const fetchWeather = () => {
          const conditions = ['Clear', 'Fog', 'Rain', 'Cloudy'];
          const condition = conditions[Math.floor(Math.random() * conditions.length)];
          const visibility = Math.floor(Math.random() * 5000) + 500;
          setWeather({ condition, temperature: Math.floor(Math.random() * 15) + 20, visibility, humidity: Math.floor(Math.random() * 40) + 40 });
          if (condition === 'Fog' && visibility < 1000) alertUser('Fog ahead. Low visibility.');
        };
        fetchWeather();
        const weatherInterval = setInterval(fetchWeather, 25000);
        return () => clearInterval(weatherInterval);
      }, []);

      // Move pedestrians a bit
      useEffect(() => {
        const interval = setInterval(() => {
          setPedestrians(prev => prev.map(ped => ({ ...ped, lat: ped.lat + (Math.random() - 0.5) * 0.0008, lng: ped.lng + (Math.random() - 0.5) * 0.0008 })));
        }, 3000);
        return () => clearInterval(interval);
      }, []);

      // Initialize Leaflet map once mapDivRef is ready
      useEffect(() => {
        if (!mapDivRef.current) return;
        if (!window.L) {
          console.error('Leaflet (L) not loaded');
          return;
        }
        if (leafletMapRef.current) return; // already initialized

        try {
          const L = window.L;
          const map = L.map(mapDivRef.current).setView([userLocation.lat, userLocation.lng], 14);
          leafletMapRef.current = map;

          L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors',
            maxZoom: 19
          }).addTo(map);

          // user marker
          const userMarker = L.marker([userLocation.lat, userLocation.lng], {
            icon: L.divIcon({
              className: 'user-marker',
              html: '<div style="background:#10b981;width:20px;height:20px;border-radius:50%;border:3px solid white;box-shadow:0 0 10px rgba(16,185,129,0.8)"></div>',
              iconSize: [24, 24]
            })
          }).addTo(map).bindPopup('<b>Your Location</b>');
          markersRef.current.push(userMarker);

          // accident zones
          accidentZones.forEach(zone => {
            const color = zone.severity === 'high' ? '#ef4444' : zone.severity === 'medium' ? '#f59e0b' : '#3b82f6';
            const circle = L.circle([zone.lat, zone.lng], { color, fillColor: color, fillOpacity: 0.25, radius: 400 }).addTo(map);
            const marker = L.marker([zone.lat, zone.lng], {
              icon: L.divIcon({ className: 'zone-marker', html: '<div style="font-size:20px">' + (zone.type === 'accident' ? '‚ö†Ô∏è' : 'üöß') + '</div>', iconSize: [28, 28] })
            }).addTo(map).bindPopup('<b>' + (zone.type === 'accident' ? 'Accident Zone' : 'Bad Road') + '</b><br>' + zone.name);
            markersRef.current.push(circle, marker);
          });

          // nearby services
          nearbyServices.forEach(service => {
            const marker = L.marker([service.lat, service.lng], {
              icon: L.divIcon({ className: 'service-marker', html: '<div style="font-size:24px">' + service.icon + '</div>', iconSize: [30, 30] })
            }).addTo(map).bindPopup('<b>' + service.name + '</b><br>Type: ' + service.type);
            markersRef.current.push(marker);
          });

          // make sure map resizes correctly
          setTimeout(() => map.invalidateSize(), 200);
        } catch (err) {
          console.error('Map initialization error:', err);
        }

        // cleanup on unmount
        return () => {
          if (leafletMapRef.current) {
            try {
              leafletMapRef.current.remove();
            } catch (e) { /* ignore */ }
            leafletMapRef.current = null;
            markersRef.current = [];
            pedestrianMarkersRef.current = [];
          }
        };
      }, [mapDivRef.current]);

      // Update pedestrian markers when pedestrians change
      useEffect(() => {
        if (!leafletMapRef.current || !window.L) return;
        const L = window.L;
        // remove old ped markers
        pedestrianMarkersRef.current.forEach(m => {
          try { leafletMapRef.current.removeLayer(m); } catch(e) {}
        });
        pedestrianMarkersRef.current = [];
        // add new
        pedestrians.forEach(ped => {
          try {
            const marker = L.marker([ped.lat, ped.lng], {
              icon: L.divIcon({ className: 'pedestrian-marker', html: '<div style="font-size:18px">üö∂</div>', iconSize: [24, 24] })
            }).addTo(leafletMapRef.current);
            pedestrianMarkersRef.current.push(marker);
          } catch (e) {
            // ignore
          }
        });
      }, [pedestrians]);

      return (
        <div className="min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 text-white">
          <button onClick={() => setShowSOSModal(true)} className="fixed bottom-6 right-6 z-50 w-16 h-16 bg-red-600 hover:bg-red-700 rounded-full shadow-2xl flex items-center justify-center animate-pulse">
            <PhoneIcon />
          </button>

          {showSOSModal && (
            <div className="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4">
              <div className="bg-slate-800 rounded-2xl p-8 max-w-md w-full border-2 border-red-500">
                <h2 className="text-3xl font-bold text-red-500 mb-4 flex items-center"><AlertIcon /> <span className="ml-3">Emergency SOS</span></h2>
                <div className="space-y-3 mb-6 text-slate-300">
                  <p>Location: {userLocation.lat.toFixed(4)}, {userLocation.lng.toFixed(4)}</p>
                  <p>Time: {new Date().toLocaleTimeString()}</p>
                  <p>Speed: {speed} km/h</p>
                </div>
                {sosStatus === 'sent' ? (
                  <div className="bg-green-500/20 border border-green-500 rounded-lg p-4 text-green-400 mb-4">Emergency message sent!</div>
                ) : (
                  <div className="flex gap-3">
                    <button onClick={handleSOS} disabled={sosStatus === 'sending'} className="flex-1 bg-red-600 hover:bg-red-700 px-6 py-3 rounded-lg font-bold disabled:opacity-50 flex items-center justify-center">
                      {sosStatus === 'sending' ? 'Sending...' : <> <SendIcon /> <span className="ml-2">Send SOS</span> </>}
                    </button>
                    <button onClick={() => setShowSOSModal(false)} className="px-6 py-3 bg-slate-700 hover:bg-slate-600 rounded-lg">Cancel</button>
                  </div>
                )}
              </div>
            </div>
          )}

          {showReportModal && (
            <div className="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4">
              <div className="bg-slate-800 rounded-2xl p-8 max-w-md w-full border border-orange-500">
                <h2 className="text-2xl font-bold mb-6 flex items-center"><AlertIcon /> <span className="ml-3">Report Road Hazard</span></h2>
                <div className="space-y-4">
                  <div>
                    <label className="block text-sm text-slate-400 mb-2">Hazard Type</label>
                    <select value={reportForm.type} onChange={(e) => setReportForm({...reportForm, type: e.target.value})} className="w-full bg-slate-700 px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 text-white">
                      <option>Pothole</option>
                      <option>Broken Road</option>
                      <option>No Street Light</option>
                      <option>Accident</option>
                      <option>Construction</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm text-slate-400 mb-2">Description</label>
                    <textarea value={reportForm.description} onChange={(e) => setReportForm({...reportForm, description: e.target.value})} className="w-full bg-slate-700 px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 h-24 text-white" placeholder="Describe the issue..." />
                  </div>
                  <div className="flex gap-3">
                    <button onClick={submitReport} className="flex-1 bg-orange-600 hover:bg-orange-700 px-6 py-3 rounded-lg font-bold">Submit Report</button>
                    <button onClick={() => setShowReportModal(false)} className="px-6 py-3 bg-slate-700 hover:bg-slate-600 rounded-lg">Cancel</button>
                  </div>
                </div>
              </div>
            </div>
          )}

          <nav className="bg-slate-900/80 backdrop-blur-sm border-b border-emerald-500/30 px-6 py-4 flex items-center justify-between sticky top-0 z-40">
            <div className="flex items-center space-x-3">
              <div className="w-10 h-10 bg-gradient-to-br from-emerald-400 to-blue-500 rounded-lg flex items-center justify-center">
                <MapPinIcon />
              </div>
              <h1 className="text-2xl font-bold bg-gradient-to-r from-emerald-400 to-blue-400 bg-clip-text text-transparent">Smart Road Safety</h1>
            </div>
            <div className="flex items-center gap-3">
              <button onClick={() => setShowReportModal(true)} className="px-4 py-2 bg-orange-600 hover:bg-orange-700 rounded-lg font-medium flex items-center gap-2">
                <AlertIcon /> <span className="hidden sm:inline">Report</span>
              </button>
              <button onClick={() => setSidebarOpen(!sidebarOpen)} className="lg:hidden p-2 hover:bg-slate-800 rounded-lg">
                {sidebarOpen ? 'Close' : 'Menu'}
              </button>
            </div>
          </nav>

          <div className="flex">
            <aside className={(sidebarOpen ? 'translate-x-0' : '-translate-x-full') + ' lg:translate-x-0 fixed lg:sticky top-16 left-0 h-[calc(100vh-4rem)] w-64 bg-slate-900/50 backdrop-blur-sm border-r border-emerald-500/30 p-4 transition-transform duration-300 z-30 overflow-y-auto'}>
              <nav className="space-y-2">
                {[
                  { id: 'map', icon: MapPinIcon, label: 'Live Map' },
                  { id: 'speed', icon: UsersIcon, label: 'Speed' },
                  { id: 'weather', icon: CloudIcon, label: 'Weather' },
                  { id: 'services', icon: Icon, label: 'Help' },
                  { id: 'pedestrians', icon: UsersIcon, label: 'Pedestrians' },
                  { id: 'reports', icon: AlertIcon, label: 'Reports' },
                  { id: 'history', icon: BellIcon, label: 'History' }
                ].map(item => (
                  <button key={item.id} onClick={() => { setActiveTab(item.id); if (window.innerWidth < 1024) setSidebarOpen(false); }} className={'w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition ' + (activeTab === item.id ? 'bg-gradient-to-r from-emerald-500 to-blue-500 shadow-lg' : 'hover:bg-slate-800/50')}>
                    <item.icon className="w-5 h-5" />
                    <span className="font-medium">{item.label}</span>
                  </button>
                ))}
              </nav>
            </aside>

            <main className="flex-1 p-4 lg:p-6 lg:ml-64">
              <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <div className="bg-slate-800/50 backdrop-blur-sm border border-emerald-500/30 rounded-xl p-6">
                  <div className="flex items-center justify-between mb-4"><UsersIcon /> <span className="text-sm text-slate-400">Speed</span></div>
                  <div className="text-center">
                    <div className={'text-5xl font-bold mb-2 ' + (speed > 80 ? 'text-red-400 animate-pulse' : 'text-emerald-400')}>{speed}</div>
                    <div className="text-slate-400">km/h</div>
                  </div>
                </div>
                <div className="bg-slate-800/50 backdrop-blur-sm border border-blue-500/30 rounded-xl p-6">
                  <div className="flex items-center justify-between mb-4"><CloudIcon /> <span className="text-sm text-slate-400">Weather</span></div>
                  <div className="text-3xl font-bold text-blue-400 mb-2">{weather.temperature}¬∞C</div>
                  <div className="text-slate-300">{weather.condition}</div>
                </div>
                <div className="bg-slate-800/50 backdrop-blur-sm border border-red-500/30 rounded-xl p-6">
                  <div className="flex items-center justify-between mb-4"><BellIcon /><span className="text-sm text-slate-400">Alerts</span></div>
                  <div className="text-3xl font-bold text-red-400 mb-2">{alerts.length}</div>
                </div>
              </div>

              {activeTab === 'map' && (
                <div className="bg-slate-800/50 backdrop-blur-sm border border-emerald-500/30 rounded-xl overflow-hidden">
                  <div className="p-4 border-b border-slate-700">
                    <h2 className="text-xl font-bold">Live Road Safety Map</h2>
                  </div>
                  <div id="map" ref={mapDivRef} className="w-full h-[500px] bg-slate-900"></div>
                  <div className="p-4 bg-slate-900/50 flex flex-wrap gap-4 text-sm">
                    <div className="flex items-center gap-2"><div className="w-3 h-3 bg-red-500 rounded-full"></div><span>High Risk</span></div>
                    <div className="flex items-center gap-2"><div className="w-3 h-3 bg-yellow-500 rounded-full"></div><span>Medium</span></div>
                    <div className="flex items-center gap-2"><span>üè• Hospital</span></div>
                    <div className="flex items-center gap-2"><span>üö∂ Pedestrians</span></div>
                  </div>
                </div>
              )}

              {activeTab === 'speed' && (
                <div className="bg-slate-800/50 border border-emerald-500/30 rounded-xl p-6">
                  <h2 className="text-2xl font-bold mb-6">Speed Monitor</h2>
                  <div className="flex items-center justify-center h-64">
                    <div className={'w-48 h-48 rounded-full border-8 flex items-center justify-center ' + (speed > 80 ? 'border-red-500' : 'border-emerald-500')}>
                      <div className="text-center">
                        <div className="text-6xl font-bold">{speed}</div>
                        <div className="text-slate-400">km/h</div>
                      </div>
                    </div>
                  </div>
                  <div className="mt-6 p-4 bg-slate-900/50 rounded-lg">
                    <div className="flex justify-between"><span className="text-slate-400">Speed Limit</span><span className="text-xl font-bold">80 km/h</span></div>
                    {speed > 80 && <div className="mt-3 p-3 bg-red-500/20 border border-red-500 rounded-lg text-red-400">Over limit by {speed - 80} km/h!</div>}
                  </div>
                </div>
              )}

              {activeTab === 'weather' && (
                <div className="bg-slate-800/50 border border-blue-500/30 rounded-xl p-6">
                  <h2 className="text-2xl font-bold mb-6">Weather Conditions</h2>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="bg-slate-900/50 p-6 rounded-lg"><div className="text-slate-400 mb-2">Temperature</div><div className="text-4xl font-bold text-blue-400">{weather.temperature}¬∞C</div></div>
                    <div className="bg-slate-900/50 p-6 rounded-lg"><div className="text-slate-400 mb-2">Condition</div><div className="text-4xl font-bold text-blue-400">{weather.condition}</div></div>
                    <div className="bg-slate-900/50 p-6 rounded-lg"><div className="text-slate-400 mb-2">Visibility</div><div className="text-4xl font-bold text-blue-400">{weather.visibility}m</div></div>
                    <div className="bg-slate-900/50 p-6 rounded-lg"><div className="text-slate-400 mb-2">Humidity</div><div className="text-4xl font-bold text-blue-400">{weather.humidity}%</div></div>
                  </div>
                </div>
              )}

              {activeTab === 'services' && (
                <div className="bg-slate-800/50 border border-blue-500/30 rounded-xl p-6">
                  <h2 className="text-2xl font-bold mb-6">Nearby Help</h2>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {nearbyServices.map((s, i) => (
                      <div key={i} className="bg-slate-900/50 p-6 rounded-lg border border-slate-700 hover:border-blue-500 transition">
                        <div className="flex items-start gap-4">
                          <div className="text-4xl">{s.icon}</div>
                          <div><h3 className="font-bold text-lg">{s.name}</h3><p className="text-slate-400">{s.type}</p><p className="text-sm text-slate-500 mt-2">{calculateDistance(userLocation.lat, userLocation.lng, s.lat, s.lng).toFixed(2)} km</p></div>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              )}

              {activeTab === 'pedestrians' && (
                <div className="bg-slate-800/50 border border-purple-500/30 rounded-xl p-6">
                  <h2 className="text-2xl font-bold mb-6 flex items-center"><UsersIcon /> Pedestrians</h2>
                  <div className="space-y-4">
                    {pedestrians.map(p => {
                      const d = calculateDistance(userLocation.lat, userLocation.lng, p.lat, p.lng);
                      return (
                        <div key={p.id} className={'p-4 rounded-lg border ' + (d < 0.05 ? 'bg-red-500/20 border-red-500' : 'bg-slate-900/50 border-slate-700')}>
                          <div className="flex items-center justify-between">
                            <div className="flex items-center gap-3"><span className="text-3xl">üö∂</span><div><div className="font-bold">Pedestrian {p.id}</div><div className="text-sm text-slate-400">{p.lat.toFixed(4)}, {p.lng.toFixed(4)}</div></div></div>
                            <div className={'px-3 py-1 rounded-full text-sm ' + (d < 0.05 ? 'bg-red-500' : 'bg-green-500/20 text-green-400')}>{d < 0.05 ? 'CLOSE!' : (d * 1000).toFixed(0) + 'm'}</div>
                          </div>
                        </div>
                      );
                    })}
                  </div>
                </div>
              )}

              {activeTab === 'reports' && (
                <div className="bg-slate-800/50 border border-orange-500/30 rounded-xl p-6">
                  <h2 className="text-2xl font-bold mb-6">Your Reports</h2>
                  <div className="space-y-3">
                    {userReports.map(r => (
                      <div key={r.id} className="bg-slate-900/50 p-4 rounded-lg border border-slate-700">
                        <div className="font-bold text-lg">üöß {r.type}</div>
                        <p className="text-slate-400 mt-2">{r.description}</p>
                        <p className="text-sm text-slate-500 mt-2">{r.lat.toFixed(4)}, {r.lng.toFixed(4)}</p>
                        <p className="text-xs text-slate-600 mt-1">{r.timestamp}</p>
                      </div>
                    ))}
                    {userReports.length === 0 && <div className="text-center text-slate-400 py-12">No reports yet</div>}
                  </div>
                </div>
              )}

              {activeTab === 'history' && (
                <div className="bg-slate-800/50 border border-red-500/30 rounded-xl p-6">
                  <h2 className="text-2xl font-bold mb-6">Alert History</h2>
                  <div className="space-y-3 max-h-[600px] overflow-y-auto">
                    {alerts.slice().reverse().map(a => (
                      <div key={a.id} className="bg-slate-900/50 p-4 rounded-lg border border-slate-700">
                        <div className="flex items-start gap-3">
                          <AlertIcon />
                          <div><div className="text-slate-200">{a.message}</div><div className="text-sm text-slate-500 mt-1">{a.time}</div></div>
                        </div>
                      </div>
                    ))}
                    {alerts.length === 0 && <div className="text-center text-slate-400 py-12">No alerts yet</div>}
                  </div>
                </div>
              )}
            </main>
          </div>
        </div>
      );
    }

    // Render
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<SmartRoadSafety />);
  </script>
</body>
</html>
